#!/usr/bin/env python3
"""
í…”ë ˆê·¸ë¨ ë´‡ ì§ì ‘ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
ì‹¤ì œë¡œ í…”ë ˆê·¸ë¨ ì±„íŒ…ë°©ì— ë©”ì‹œì§€ê°€ ì˜¤ëŠ”ì§€ í™•ì¸
"""

import sys
import asyncio
from pathlib import Path

# í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œ ì¶”ê°€
project_root = Path(__file__).parent
sys.path.append(str(project_root))

from shared.apis.telegram_api import TelegramBotClient

async def test_telegram_direct():
    """í…”ë ˆê·¸ë¨ ë´‡ ì§ì ‘ í…ŒìŠ¤íŠ¸"""
    try:
        print("ğŸš€ í…”ë ˆê·¸ë¨ ë´‡ ì§ì ‘ í…ŒìŠ¤íŠ¸ ì‹œì‘")
        
        # í…”ë ˆê·¸ë¨ ë´‡ í´ë¼ì´ì–¸íŠ¸ ìƒì„±
        telegram_bot = TelegramBotClient()
        
        # í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€
        test_message = """
ğŸ”” **í…ŒìŠ¤íŠ¸ ì•Œë¦¼** ğŸ””

ğŸ“Š **ì„œë¹„ìŠ¤**: í…ŒìŠ¤íŠ¸ ì„œë¹„ìŠ¤
ğŸ¢ **ì¢…ëª©**: ë¯¸ë˜ì—ì…‹ì¦ê¶Œ (006800)
ğŸ“… **ì‹œê°„**: í…ŒìŠ¤íŠ¸ ì‹œê°„
ğŸ’¡ **ë‚´ìš©**: ì´ ë©”ì‹œì§€ê°€ ë³´ì´ë©´ í…”ë ˆê·¸ë¨ ë´‡ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!

âœ… **í…ŒìŠ¤íŠ¸ ì„±ê³µ**
        """
        
        print("ğŸ“¤ í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì¤‘...")
        
        # ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë©”ì‹œì§€ ì „ì†¡
        result = telegram_bot.send_message(test_message)
        
        if result:
            print("âœ… í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ!")
            print("ğŸ“± í…”ë ˆê·¸ë¨ ì±„íŒ…ë°©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
        else:
            print("âŒ í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨!")
            
    except Exception as e:
        print(f"âŒ í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: {e}")
        import traceback
        traceback.print_exc()

async def test_telegram_async():
    """í…”ë ˆê·¸ë¨ ë´‡ ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸"""
    try:
        print("ğŸš€ í…”ë ˆê·¸ë¨ ë´‡ ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘")
        
        # í…”ë ˆê·¸ë¨ ë´‡ í´ë¼ì´ì–¸íŠ¸ ìƒì„±
        telegram_bot = TelegramBotClient()
        
        # í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€
        test_message = """
ğŸ”” **ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì•Œë¦¼** ğŸ””

ğŸ“Š **ì„œë¹„ìŠ¤**: ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì„œë¹„ìŠ¤
ğŸ¢ **ì¢…ëª©**: ë¯¸ë˜ì—ì…‹ì¦ê¶Œ (006800)
ğŸ“… **ì‹œê°„**: ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì‹œê°„
ğŸ’¡ **ë‚´ìš©**: ì´ ë©”ì‹œì§€ê°€ ë³´ì´ë©´ ë¹„ë™ê¸° í…”ë ˆê·¸ë¨ ë´‡ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!

âœ… **ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì„±ê³µ**
        """
        
        print("ğŸ“¤ ë¹„ë™ê¸° í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì¤‘...")
        
        # ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë©”ì‹œì§€ ì „ì†¡
        result = await telegram_bot.send_message_async(test_message)
        
        if result:
            print("âœ… ë¹„ë™ê¸° í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ!")
            print("ğŸ“± í…”ë ˆê·¸ë¨ ì±„íŒ…ë°©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
        else:
            print("âŒ ë¹„ë™ê¸° í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨!")
            
    except Exception as e:
        print(f"âŒ ë¹„ë™ê¸° í…”ë ˆê·¸ë¨ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: {e}")
        import traceback
        traceback.print_exc()

async def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    print("=" * 60)
    print("ğŸ”” í…”ë ˆê·¸ë¨ ë´‡ ì§ì ‘ í…ŒìŠ¤íŠ¸")
    print("=" * 60)
    
    # ë™ê¸° í…ŒìŠ¤íŠ¸
    await test_telegram_direct()
    
    print("\n" + "=" * 60)
    
    # ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸
    await test_telegram_async()
    
    print("\n" + "=" * 60)
    print("ğŸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ")

if __name__ == "__main__":
    asyncio.run(main()) 